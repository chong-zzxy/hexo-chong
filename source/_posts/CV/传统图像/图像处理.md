---
author: chong
title:  图像处理
data: 2022-01-10 12:00:00
categories: CV
---

# 图像处理

> 网址：http://www.chenjianqu.com/

##### 一、图像处理—仿射变换

- 图像平移：X和Y方向移动

- 镜像变换：
  - 图像的水平镜像：x=x0, y=N-y0+1 实际使用时-1
  - 图像的垂直镜像：y=y0, x=M-x0+1 实际使用时-1

##### 二、图像处理—放大和缩小

1. 图像缩小：通过减少像素个数来实现的

   - 根据缩小的尺寸，从原图像中选择合适的像素点，使图像缩小后可以保持原有图像的特征。
   - 算法：等间隔采样、局部均值。

2. 图像放大

   - 要将该图像放大两倍，可以有很多种算法，最简单的方法为邻域插值，即将每一个原像素原封不动地复制映射到扩展后对应四个像素中：这种方法在放大图像的同时保留了所有的原图像的所有信息，但是会产生锯齿现象。

     双线性插值的效果对于放大的图像而言较领域插值来得平滑，但是却使得图像变得模糊而且仍然会有一部分锯齿现象。

     双三次插值更好比双线性插值更好。

##### 三、图像处理—点运算

> 图像的点运算就是对图像中的每一个像素点进行计算，为像素点和像素点之间的运算。
> 函数表示形式为 :B(x,y)=f[A(x,y)]，其中f为映射函数。点运算有时候被称为灰度变换。

1. 线性点运算：线性点运算的函数形式可用线性方程来描述，即：G(i,j)=T[f(i,j)]=af(i,j)+b

   - 当a>1 时，输出图像的对比度增大；a<1时对比度减小。

     当a=1，把！=0时，图像仅亮度发生变化。

     当a=-1,b=255时，输出图像的灰度会反转。

2. 对数变换

   - 能够对图像中低灰度细节进行增强
   - 反对数变换的作用是压缩灰度值较低的区间，扩展高灰度值的区间。

3. 伽马变换

   - 伽马变换又称指数变换或幂变换，公式：out=c*(src+e)^r

   - r>1, 较亮的区域灰度被拉伸，较暗的区域灰度被压缩的更暗，图像整体变暗；

     r<1, 较亮的区域灰度被压缩，较暗的区域灰度被拉伸的较亮，图像整体变亮；

##### 四、图像处理—逻辑运算

1. 对图像求反

   - 对于黑白图像来说，黑变白 百变黑
   - 对于灰度图像来说，将255减去原像素值即为求反。
   - 应用：
     - 求取图像的阴影面积
     - 求取图像的补图像
2. 与运算

   - 当两个图像对应的像素同时为真时，结果为真。
   - 应用： 主要用于求两幅二值图像的相交部分。
3. 或运算
   - 当两个图像对应的像素有一个为真时，结果为真。
   - 应用：主要用于求两幅二值图像的合并。
4. 异或运算
   - 当两个图像对应的像素相同时，结果为真；反之为假。
   - 应用：
     - 得到两幅图像中不想交的部分
     - 绘制区别于背景的，可恢复的图像

##### 五、图像处理—二值形态学运算

> 其基本的运算包括：腐蚀和膨胀、开运算和闭运算、骨架抽取、极限腐蚀、击中击不中变换、形态学梯度、Top-hat变换、颗粒分析、流域变换等。

1. 腐蚀

   - 腐蚀操作会收缩（细化）图像中物体的轮廓，可以用来断开（分离）物体间的连接，消除离散点，代价是导致物体的面积比原来的面积要小。

   - \1. 用结构元素，扫描图像的每一个像素

     \2. 用结构元素与其覆盖的二值图像做“与”操作

     \3. 如果都为1，结果图像的该像素为1。否则为0

   - 也就是查找被处理图像中能不能找到和结构元素相同的矩阵。如果存在那么中心点所对应的点就为1，否则为0.

2. 膨胀

   - 膨胀操作会扩大（粗化）图像中物体的轮廓，可以用来弥补（填充）物体间的孔洞，强化离散点，代价是导致物体的面积比原来的面积要大。

   - \1. 用结构元素，扫描图像的每一个像素

     \2. 用结构元素与其覆盖的二值图像做“与”操作

     \3. 如果都为0，结果图像的该像素为0。否则为1

   - 在结构元素覆盖范围下，只要有一个像素符和结构元素像素相同，那么中心点对应点就为1，否则为0.

3. 闭运算

   - **闭运算是使用同一结构元对图像进行先膨胀后腐蚀的操作，可以用来弥合较窄的间断和细长的沟壑，消除物体间小的孔洞，填补轮廓线中的断裂。**

     闭运算=先进行膨胀运算，在进行腐蚀运算

4. 开运算

   - 开运算是使用同一结构元对图像进行先腐蚀后膨胀的操作，可以用来平滑物体的轮廓，断开物体间较窄的连接，消除物体边沿尖锐的突出部分。

     开运算 = 先腐蚀运算，再膨胀运算。


##### 六、图像处理—直方图均衡化

> 是通过拉伸像素强度分布范围来增强图像对比度的一种方法。
>
> 是图像处理领域中利用图像直方图对对比度进行调整的方法。

> 直方图均衡化是通过调整图像的灰阶分布，使得在0~255灰阶上的分布更加均衡，提高了图像的对比度，达到改善图像主观视觉效果的目的。对比度较低的图像适合使用直方图均衡化方法来增强图像细节。
>
> 这种方法通常用来**增加许多图像的全局对比度**，尤其是当图像的有用数据的对比度相当接近的时候。通过这种方法，亮度可以更好地在直方图上分布。
>
> 这样就可以用于增强局部的对比度而不影响整体的对比度，直方图均衡化通过有效地扩展常用的亮度来实现这种功能。这种方法对于背景和前景都太亮或者太暗的图像非常有用。

- 优势：它是一个相当直观的技术并且是可逆操作，如果已知均衡化函数，那么就可以恢复原始的直方图，并且计算量也不大。

- 一个缺点是它对处理的数据不加选择，它可能会增加背景噪声的对比度并且降低有用信号的对比度。

- 算法步骤：

  1. 统计原始图像各灰度级的像素数目ni,0≤i<L，L是图像中所有的灰度值（通常为256）

  2. 图像中灰度为i的像素的出现概率是:px(i)=p(x=i)=ni/n,n是图像中所有的像素数，px(i)实际上是像素值为i的图像的直方图，归一化到[0, 1]；

  3. px的累积分布函数,是图像的累计归一化直方图

     

  4. 直方图均衡化计算公式, cdfmin为累积分布函数最小值，M和N分别代表了图像的长宽像素个数，而L则是灰度级数(如图像为8位深度，则灰度级别共有2^8=256级数，这也是最常见的灰度级数)，v为原始图像中为v的像素值


##### 七、图像处理—空间域平滑滤波

1. 空间域和频域的概念

   - 空间域　英文： spatial domain。 释义： 又称图像空间(image space)。由图像像元组成的空间。在图像空间中以长度(距离)为自变量直接对像元值进行处理称为空间域处理。
   - 频率域。 英文： spatial frequency domain。 释义： 以频率(即波数)为自变量描述图像的特征,可以将一幅图像像元值在空间上的变化分解为具有不同振幅、空间频率和相位的简振函数的线性叠加,图像中各种频率成分的组成和分布称为空间频谱。这种对图像的频率特征进行分解、处理和分析称为频率域处理或波数域处理。

2. 图像滤波

   - 在尽量保留图像细节特征的条件下对目标图像的噪声进行抑制。
   - （滤波就是要去除没用的信息，保留有用的信息，可能是低频，也可能是高频）。
   - 目的：
     - 是抽出对象的特征作为图像识别的特征模式;
     - 适应图像处理的要求，消除图像数字化时所混入的噪声。
   - 可分为：
     - 空间域滤波：通过图像卷积运算实现
     - 可频域滤波：通过傅里叶变换实现

3. 图像卷积

   - 卷积运算：可看作是加权求和的过程，使用到的图像区域中的每个像素分别于卷积核(权矩阵)的每个元素对应相乘，所有乘积之和作为区域中心像素的新值。
   - 卷积核：卷积时使用到的权用一个矩阵表示，该矩阵是一个权矩阵。不同的卷积核对应不同的滤波器。
   - 边界问题：当处理图像边界像素时，卷积核与图像使用区域不能匹配，卷积核的中心与边界像素点对应，卷积运算将出现问题。
     - 解决办法：1.复制边界，2.忽略边界，3.设定边界值。

4. 常用空间滤波器

   - 空间域滤波

     - 空间平滑滤波器：均值滤波、加权均值滤波、阈值平均滤波、中值滤波、高斯滤波等
     - 空间锐化滤波器

   - > **平滑滤波**用于模糊处理和降低噪声。
     >
     > 模糊处理常用于预处理任务中，如在目标提取之前去除图像中的一些琐碎细节，以及桥接直线或曲线的缝隙。通过线性或非线性平滑滤波也可降低噪声。

5. 阈值平均滤波

   - 阈值平均滤波就是在平均滤波的基础上加上阈值的约束
   - 即当像素点与图像均值的差小于设定的阈值时，输出像素点等于原像素点，否则求其对该像素点进行求模板均值。

##### 八、图像处理—空间域锐化滤波

1. 锐化滤波

   - 与平滑滤波的积分运算或平均运算相反，锐化滤波对图像求导，或者说求差分

   - 将图像的低频部分减弱或去除，保留图像的高频部分，即图像的边缘信息。

     图像的边缘、轮廓一般位于灰度突变的地方，也就是图像的高频部分

     **通常用灰度差分提取边缘轮廓**。

   - 常见的锐化滤波的方法有通过一阶微分算子和二阶微分算子进行卷积运算

2. 一阶_Robert算子

3. 一阶_Sobel算子

4. 一阶_Prewitt算子

5. 二阶_拉普拉斯算子

6. 一阶微分算子和二阶微分算子的对比

   - 二阶导数增强域不是频率最高的部分（边缘），而有一定偏差，并且增强幅度并不如一阶导数。
   - 如果求绝对值，图像负y轴部分翻正，会产生双边缘

   > **Laplace算子** 做锐化滤波的特点
   >
   > 1.对噪声敏感
   >
   > 2.产生双边源
   >
   > 3.缓慢区域产生暗背景

7. 图像锐化

   - 各种算子进行滤波处理得到边缘图像
   - 想要的是增强后的图像，只需要**将锐化得到的图像与原图线性相加即可**

##### 九、图像处理—RBG图像和灰度图像

1. 色度图

   - 明度、色调和饱和度称为颜色视觉三特性

   - 国际照明委员会（CIE）1931年制定了一个色度图，用组成某一颜色的三基色比例来规定这一颜色，即用三种基色相加的比例来表示某一颜色，并可写成方程式：**(Color)=R(R)+G(G)+B(B)**

     式中，（C）代表某一种颜色，（R）、（G）、（B）是红、绿、蓝三基色

     R、G、B是每种颜色的比例系数，它们的和等于1，即R+G+B=1，“C”是指匹配即在视觉上颜色相同，如某一蓝绿色可以表达为：(C)=0.06(R)+0.31(G)+0.63(B)

   - 色度图如下

     **X** **轴色度坐标相当于红基色的比例** 

     **Y** **轴色度坐标相当于绿基色的比例** 

     图中没有Z轴色度坐标（即蓝基色所占的比例）。

   - ##### RGB颜色空间不能表示自然界所有的颜色

2. 灰度图像

   - 灰度数字图像是每个像素只有一个采样颜色的图像。这类图像通常显示为从最暗黑色到最亮的白色的灰度，尽管理论上这个采样可以任何颜色的不同深浅，甚至可以是不同亮度上的不同颜色。灰度图像与黑白图像不同，在计算机图像领域中黑白图像只有黑白两种颜色，灰度图像在黑色与白色之间还有许多级的颜色深度。

3. RBG转灰度方法

   1. ```
      很著名的心理学公式：
      Gray = R*0.299 + G*0.587 + B*0.114
      ```

   2. ```
      实际应用时，希望避免低速的浮点运算，所以需要整数算法。
      注意到系数都是3位精度的没有，我们可以将它们缩放1000倍来实现整数运算算法
      Gray = (R*299 + G*587 + B*114 + 500) / 1000
      ```

   3. ```
      Gray = (R*19595 + G*38469 + B*7472) >> 16
      ```

   4. ```
      这一种是 Adobe Photoshop 里的公式 Adobe RGB (1998) [gamma=2.20]
      Gray = (R^2.2 * 0.2973 + G^2.2 * 0.6274 + B^2.2 * 0.0753)^(1/2.2)
      该方法运行速度慢，但是效果很好。
      ```

   5. ```
      平均值方法
      GRAY = (RED+BLUE+GREEN)/3
      （GRAY,GRAY,GRAY）替代（RED,GREEN,BLUE）
      但是这样做的精度比较低，图像转化为灰度效果不是太好
      ```

      

