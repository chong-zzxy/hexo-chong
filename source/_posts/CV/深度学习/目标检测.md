---
author: chong
title:  目标检测
data: 2022-01-10 12:00:00
categories: CV
---



# 目标检测：



> #### 目标检测是在图片中对 *<u>可变数量</u>* 的目标进行查找和分类

- 目标种类与数量问题

- 目标尺度问题

- 外在环境干扰问题

- > 形态 + 视角



> # 目标检测 VS 图像分类

![image-20210421203857249](./images/image-20210421203857249.png)

位置 + 分类 （不同颜色不同类 + 置信值）



> #  目标检测 VS 目标分割

![image-20210421204205130](./images/image-20210421204205130.png)

​		c 语义分割   		d 实例分割



上采样，反卷积 



> # 算法基本流程

![image-20210421205641514](./images/image-20210421205641514.png)

**NMS：非极大值抑制**

低层次：颜色、纹理、形状

中层次

高层次：语义



> # 深度学习目标检测方法
>
> ### One-stage（YOLO和SSD系列）
>
> ### Two-stage（Faster RCNN系列 ）

![image-20210421210259742](./images/image-20210421210259742.png)



##### 常用传统目标检测方法

1. Viola-Jones（人脸检测）

   - Haar特征抽取
     - Haar-----差分（value = 白 - 黑）
     - <img src="./images/image-20210624151806046.png" alt="image-20210624151806046" style="zoom: 50%;" />
   - 训练人脸分类器（Adaboost算法）
     - 初始化样本的权重w，样本权重之和为1
     - 训练弱化分类器
     - 更新样本权重
     - 循环第2步
     - 结合做个分类器结果，进行投票
   - 滑动窗口（大小、步长=>>大量冗余候选框=>>性能下降）

2. HOG + SVM（行人检测、Opencv实现）

   - 提取HOG特征
     - 灰度化 + Gamma变换（值进行根号求解）
     - 计算梯度map
     - 图像划分成小的cell，统计每个cell梯度直方图
     - 多个cell组成一个block，特征归一化
     - 多个block串联，并归一化
   - 训练SVM分类器（最大分类间隔面） 
   - 利用滑动窗口提取目标区域，进行分类判断
   - NMS
   - 输出检测结果

3. DPM（物体检测）

   > HOG的扩展，利用SVM训练得到物体的梯度

   - DPM特征抽取
     - 有符号梯度
     - 无符号梯度

   ![image-20210624155645328](./images/image-20210624155645328.png)

   - 计算DPM特征图
   - 计算相应图
   - Latent SNM分类器训练
   - 检测识别

4. NMS（非极大值抑制算法）

   - 目的：为了消除多余的框，找到最佳的物体检测位置

   - 思想：选取那些领域里分数最高的窗口，同时抑制那些分数低的窗口

   - Soft-NMS

     

   - 相邻区域内的检测框的分数进行调整而非彻底抑制，从而提高了高检测率情况下的准确率

   - 在低检索率时仍能对物体检测性能有明显提升

   - ![image-20210624161524271](./images/image-20210624161524271.png)



##### Two-stage

###### 基本介绍

- CNN卷积特征
- R.Girshick et al.，2014提出R-CNN到faster RCNN
- 端到端的目标检测（RPN网络）
- 准确率高、速度相对one-stage慢

###### 基本流程：

![image-20210625091526621](./images/image-20210625091526621.png)

###### 常见算法：

![image-20210625092126244](./images/image-20210625092126244.png)

###### 核心组件

1. CNN网络（主干网络）

   - 从简到繁再到简的卷积神经网
   - 多尺度特征融合的网络
   - 更轻量级的CNN网络

2. RPN网络

   - 区域推荐（Anchor机制）
     - feature map = n * c * w * h
     - 锚点-候选区域的中心点-一个Anchor
     - 9个不同尺度的区域
     - 候选区域 = w * h * 9（以9为例）
     - IOU
   - ROI Pooling
     - 输入：特征图、rois（1 * 5 * 1 * 1）已经ROI参数
     - 输出：固定尺寸的feature map
   - 分类和回归
   - <img src="./images/image-20210625093505845.png" alt="image-20210625093505845" style="zoom:67%;" />

   

###### 改进方向：

- 更好的网络特征
- 更准确的RPN
- 更完善的ROI分类
- 样本后处理
- 更大的mini-Batch



##### One-stage

###### 基本介绍：

- 使用CNN卷积特征
- 直接回归物体的类别概率和位置坐标值（无region proposal）
- 准确率低、速度相对two-stage快

###### 基本流程：

![image-20210625095705486](./images/image-20210625095705486.png)

###### 常见算法：

![image-20210625095907242](./images/image-20210625095907242.png)

###### 核心组件

- CNN网络（主干网络）核心组件

  - 从简到繁再到简的卷积神经网

  - 多尺度特征融合的网络
  - 更轻量级的CNN网络

- 回归网络

  - 区域回归（置信度、位置、类别）
  - Anchor机制（SSD）
  - ![image-20210625101159231](./images/image-20210625101159231.png)
  - ![image-20210625101210679](./images/image-20210625101210679.png)

回归预测网络过程（Yolo）

![Yolo](./images/image-20210625105817098.png)

###### One-stage VS Two-stage

| One-stage                         | Two-stage                   |
| --------------------------------- | --------------------------- |
| 优点：                            | 优点：                      |
| **速度快**                        | **精度高（定位、检出率） ** |
| 避免背景错误，产生false positives | Anchor机制                  |
| 学到物体泛化特征                  | 共享计算量                  |
|                                   |                             |
| 缺点：                            | 缺点：                      |
| 精度低（定位、检出率）            | **速度慢**                  |
| **小物体的检测效果不好**          | 训练时间长                  |
|                                   | 误报高                      |



##### SSD系列算法原理介绍

###### 算法介绍：

Single Shot MultiBox Detector（one-stage方法）

- Wei Liu在ECCV 2016提出
- 直接回归目标类别和位置
- 不同尺度的特征图上进行预测
- 端到端的训练
- 图像的分辨率比较低，也能保证检测的精度



![image-20210626153841326](./images/image-20210626153841326.png)

- 主干网络：VGGNet
- 多尺度Feature Map预测
- Default bounding boxes的类别分数、偏移量



###### 主干网络介绍：

- VGG、ResNet、MobileNets等，各种卷积神经网
- 将VGG最后两个FC改成卷积，并增加4个卷积层





























